# Incident Response Playbook: Endpoint Malware / EDR Alert

## Detection Triggers
- EDR alert for malware, suspicious process, or exploit behavior
- Suspicious parent/child process relationships
- Execution from unusual paths (e.g., user temp directories)
- EDR behavioral detections (credential dumping, persistence attempts)

## Initial Triage (0â€“15 minutes)
- Identify affected endpoint:
  - hostname
  - user
  - operating system
- Review EDR alert details:
  - detection name
  - process tree
  - file hash and path
  - command-line arguments
- Determine severity:
  - commodity malware vs targeted behavior
  - user workstation vs server
  - presence of credential access indicators

## Containment Actions
- Isolate the endpoint from the network via EDR
- Block identified hashes and indicators across the environment
- Disable affected user account if credential compromise is suspected
- Preserve forensic data before remediation if needed

## Investigation Steps
- Review full process tree and parent process
- Identify initial execution vector:
  - phishing attachment/link
  - drive-by download
  - lateral movement
- Check for persistence mechanisms:
  - scheduled tasks
  - registry run keys
  - startup folders
  - services
- Search environment for:
  - same hash
  - similar command lines
  - related indicators
- Review recent authentication activity for the affected user

## Recovery
- Remove malicious files and persistence mechanisms
- Reimage endpoint if integrity cannot be assured
- Reset credentials for affected users
- Reconnect endpoint to the network after validation

## Communication
- Notify the affected user with clear guidance
- Notify IT/security stakeholders
- Escalate to management if lateral movement or data access is suspected

## Lessons Learned / Improvements
- Was EDR detection timely and accurate?
- Could email/web filtering have prevented initial execution?
- Should endpoint hardening or application control be improved?
- Are user awareness or phishing protections sufficient?
